# Описание программы Метод FIFO

Банк заложил в стратегическое развитие направление по брокерскому обслуживанию клиентов. Согласно стратегии, ежемесячно происходит увеличение количества новых клиентов. 
Соответственно, увеличивается общее количество совершаемых сделок  купли/продажи акций.

**Проблема:**
Существующее ПО не позволяет производить расчет налогов по сделкам клиентов на фондовом рынке методом FIFO. Поэтому сотрудники бэк-офиса производят данный расчет по каждому клиенту вручную. 

**Решение:**

На время интеграции нового ПО (период интеграции от 8 до 12 месяцев), разработать надстройку для автоматического расчета налогов по клиентам

**Описание решения:**
1. Для автоматизации расчета налоговой базы будет использоваться язык Python. Так как данный язык полюбился многим разработчикам для обработки и анализа данных. 
2. Основные библиотеки: Pandas, Numpy
3. Среда разработки и сборки проекта: Microsoft Visual Studio+pyinstaller
4. Место хранения и отображения данных: Excel

**Описание работы программы:**
![image](https://user-images.githubusercontent.com/34000097/180643541-19501e01-24e4-47ba-9d60-1439e659c24e.png)

 Входные биржевые файлы приходят в формате xml. Изначально планировалось сделать парсер входного файла и преобразовать его в таблицу. 
 Для этого использовались следующие библиотеки: BeautifulSoup, xml.etree.ElementTree, xml.dom/minidom. Однако быстро решить задачу таким способом не удалось. 
 Также, биржевой файл был в другой структуре, в виде текстового отчета в excel в формате .xlsb. Для этого файла был написан отдельный парсер.
 Однако, оказалось, если открывать xml-файл в excel как xml-таблица, то файл откроется в формате обычной таблицы с наименованиями колонок без пропусков в данных. 
 Поэтому было принято решение, все биржевые файлы преобразовать в формат .xlsx и сформировать БД по купленным и проданным акциям. 
 Далее, при появлении новых файлов добавлять данные к историческим данным.

**Алгоритм работы программы:**
1.	Программа забирает входной биржевой файл
2.	Сортирует на купленные и проданные акции
3.	Записывает полученные данные в БД с купленными и в БД с проданными акциями
4.	Загружает тарифные планы по клиентам
5.	Формирует файл с комиссиями купленными/проданными акциями
6.	Собирает файл по методу ФИФО, где в каждой строке одинаковое количество купленных/проданных акций
7.	Выравнивает комиссии по купленным и проданным акциям
8.	Выводит конечный результат по налоговой базе каждого клиента в файл Excel
